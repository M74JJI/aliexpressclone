{"version":3,"sources":["pages/admin/coupon/CreateCouponPage.js"],"names":["CreateCouponPage","useState","name","setName","expiry","setExpiry","discount","setDiscount","loading","setLoading","coupons","setCoupons","user","useSelector","state","useEffect","loadAllCoupons","getCoupons","then","res","data","className","onSubmit","e","preventDefault","createCoupon","token","toast","success","catch","err","console","log","type","onChange","target","value","autoFocus","required","selected","Date","date","length","scope","map","c","key","_id","toLocaleDateString","onClick","couponId","window","confirm","removeCoupon","error"],"mappings":"oNAkJeA,UArIU,WAAO,IAAD,EACLC,mBAAS,IADJ,mBACtBC,EADsB,KAChBC,EADgB,OAEDF,mBAAS,IAFR,mBAEtBG,EAFsB,KAEdC,EAFc,OAGGJ,mBAAS,IAHZ,mBAGtBK,EAHsB,KAGZC,EAHY,OAICN,mBAAS,IAJV,mBAItBO,EAJsB,KAIbC,EAJa,OAKCR,mBAAS,IALV,mBAKtBS,EALsB,KAKbC,EALa,KAQrBC,EAASC,aAAY,SAACC,GAAD,sBAAiBA,MAAtCF,KAERG,qBAAU,WACRC,MACC,IAEH,IAAMA,EAAiB,kBAAMC,cAAaC,MAAK,SAACC,GAAD,OAASR,EAAWQ,EAAIC,UA+BvE,OACE,yBAAKC,UAAU,mBACb,yBAAKA,UAAU,OACb,yBAAKA,UAAU,YACb,kBAAC,IAAD,OAEF,yBAAKA,UAAU,aACZb,EACC,wBAAIa,UAAU,eAAd,cAEA,sCAGF,0BAAMC,SA1CO,SAACC,GACpBA,EAAEC,iBACFf,GAAW,GAEXgB,YAAa,CAAEvB,OAAME,SAAQE,YAAYM,EAAKc,OAC3CR,MAAK,SAACC,GACLV,GAAW,GACXO,IACAb,EAAQ,IACRI,EAAY,IACZF,EAAU,IACVsB,IAAMC,QAAN,WAAkBT,EAAIC,KAAKlB,KAA3B,oBAED2B,OAAM,SAACC,GAAD,OAASC,QAAQC,IAAI,oBAAqBF,QA8B3C,yBAAKT,UAAU,cACb,2BAAOA,UAAU,cAAjB,QACA,2BACEY,KAAK,OACLZ,UAAU,eACVa,SAAU,SAACX,GAAD,OAAOpB,EAAQoB,EAAEY,OAAOC,QAClCA,MAAOlC,EACPmC,WAAS,EACTC,UAAQ,KAIZ,yBAAKjB,UAAU,cACb,2BAAOA,UAAU,cAAjB,cACA,2BACEY,KAAK,OACLZ,UAAU,eACVa,SAAU,SAACX,GAAD,OAAOhB,EAAYgB,EAAEY,OAAOC,QACtCA,MAAO9B,EACPgC,UAAQ,KAIZ,yBAAKjB,UAAU,cACb,2BAAOA,UAAU,cAAjB,UACA,6BACA,kBAAC,IAAD,CACEA,UAAU,eACVkB,SAAU,IAAIC,KACdJ,MAAOhC,EACP8B,SAAU,SAACO,GAAD,OAAUpC,EAAUoC,IAC9BH,UAAQ,KAIZ,4BAAQjB,UAAU,2BAAlB,SAGF,6BAEA,4BAAKX,EAAQgC,OAAb,YAEA,2BAAOrB,UAAU,wBACf,2BAAOA,UAAU,eACf,4BACE,wBAAIsB,MAAM,OAAV,QACA,wBAAIA,MAAM,OAAV,UACA,wBAAIA,MAAM,OAAV,YACA,wBAAIA,MAAM,OAAV,YAIJ,+BACGjC,EAAQkC,KAAI,SAACC,GAAD,OACX,wBAAIC,IAAKD,EAAEE,KACT,4BAAKF,EAAE3C,MACP,4BAAK,IAAIsC,KAAKK,EAAEzC,QAAQ4C,sBACxB,4BAAKH,EAAEvC,SAAP,KACA,4BACE,kBAAC,IAAD,CACE2C,QAAS,kBAvFPC,EAuF0BL,EAAEE,SAtF5CI,OAAOC,QAAQ,aACjB3C,GAAW,GACX4C,YAAaH,EAAUtC,EAAKc,OACzBR,MAAK,SAACC,GACLH,IACAP,GAAW,GACXkB,IAAM2B,MAAN,kBAAuBnC,EAAIC,KAAKlB,KAAhC,iBAED2B,OAAM,SAACC,GAAD,OAASC,QAAQC,IAAIF,QATb,IAACoB,GAwFF7B,UAAU","file":"static/js/37.cb0b2e58.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { toast } from \"react-toastify\";\nimport DatePicker from \"react-datepicker\";\nimport {\n  getCoupons,\n  removeCoupon,\n  createCoupon,\n} from \"../../../functions/coupon\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport { DeleteOutlined } from \"@ant-design/icons\";\nimport AdminNav from \"../../../components/nav/AdminNav\";\n\nconst CreateCouponPage = () => {\n  const [name, setName] = useState(\"\");\n  const [expiry, setExpiry] = useState(\"\");\n  const [discount, setDiscount] = useState(\"\");\n  const [loading, setLoading] = useState(\"\");\n  const [coupons, setCoupons] = useState([]);\n\n  // redux\n  const { user } = useSelector((state) => ({ ...state }));\n\n  useEffect(() => {\n    loadAllCoupons();\n  }, []);\n\n  const loadAllCoupons = () => getCoupons().then((res) => setCoupons(res.data));\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setLoading(true);\n    // console.table(name, expiry, discount);\n    createCoupon({ name, expiry, discount }, user.token)\n      .then((res) => {\n        setLoading(false);\n        loadAllCoupons(); // load all coupons\n        setName(\"\");\n        setDiscount(\"\");\n        setExpiry(\"\");\n        toast.success(`\"${res.data.name}\" is created`);\n      })\n      .catch((err) => console.log(\"create coupon err\", err));\n  };\n\n  const handleRemove = (couponId) => {\n    if (window.confirm(\"Delete?\")) {\n      setLoading(true);\n      removeCoupon(couponId, user.token)\n        .then((res) => {\n          loadAllCoupons(); // load all coupons\n          setLoading(false);\n          toast.error(`Coupon \"${res.data.name}\" deleted`);\n        })\n        .catch((err) => console.log(err));\n    }\n  };\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"col-md-2\">\n          <AdminNav />\n        </div>\n        <div className=\"col-md-10\">\n          {loading ? (\n            <h4 className=\"text-danger\">Loading...</h4>\n          ) : (\n            <h4>Coupon</h4>\n          )}\n\n          <form onSubmit={handleSubmit}>\n            <div className=\"form-group\">\n              <label className=\"text-muted\">Name</label>\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                onChange={(e) => setName(e.target.value)}\n                value={name}\n                autoFocus\n                required\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label className=\"text-muted\">Discount %</label>\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                onChange={(e) => setDiscount(e.target.value)}\n                value={discount}\n                required\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label className=\"text-muted\">Expiry</label>\n              <br />\n              <DatePicker\n                className=\"form-control\"\n                selected={new Date()}\n                value={expiry}\n                onChange={(date) => setExpiry(date)}\n                required\n              />\n            </div>\n\n            <button className=\"btn btn-outline-primary\">Save</button>\n          </form>\n\n          <br />\n\n          <h4>{coupons.length} Coupons</h4>\n\n          <table className=\"table table-bordered\">\n            <thead className=\"thead-light\">\n              <tr>\n                <th scope=\"col\">Name</th>\n                <th scope=\"col\">Expiry</th>\n                <th scope=\"col\">Discount</th>\n                <th scope=\"col\">Action</th>\n              </tr>\n            </thead>\n\n            <tbody>\n              {coupons.map((c) => (\n                <tr key={c._id}>\n                  <td>{c.name}</td>\n                  <td>{new Date(c.expiry).toLocaleDateString()}</td>\n                  <td>{c.discount}%</td>\n                  <td>\n                    <DeleteOutlined\n                      onClick={() => handleRemove(c._id)}\n                      className=\"text-danger pointer\"\n                    />\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CreateCouponPage;\n"],"sourceRoot":""}