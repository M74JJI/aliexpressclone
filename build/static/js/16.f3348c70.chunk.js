(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[16],{1102:function(e,t,n){},1103:function(e,t,n){},1142:function(e,t,n){"use strict";n.r(t);var r=n(5),a=n(12),c=n(1),o=n.n(c),l="https://js.stripe.com/v3",s=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,i="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",u=null,p=function(e){return null!==u?u:u=new Promise((function(t,n){if("undefined"!==typeof window)if(window.Stripe&&e&&console.warn(i),window.Stripe)t(window.Stripe);else try{var r=function(){for(var e=document.querySelectorAll('script[src^="'.concat(l,'"]')),t=0;t<e.length;t++){var n=e[t];if(s.test(n.src))return n}return null}();r&&e?console.warn(i):r||(r=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(l).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n}(e)),r.addEventListener("load",(function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))})),r.addEventListener("error",(function(){n(new Error("Failed to load Stripe.js"))}))}catch(a){return void n(a)}else t(null)}))},m=function(e,t,n){if(null===e)return null;var r=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.9.0",startTime:t})}(r,n),r},f=Promise.resolve().then((function(){return p(null)})),d=!1;f.catch((function(e){d||console.warn(e)}));var y=n(691),b=n(8),E=n.n(b),v=n(15),h=n(10),g=n(14),O=n.n(g),j=n(2),S=(n(239),n(52)),w=function(e){e.history,e.address;var t=Object(h.b)(),n=Object(h.c)((function(e){return Object(a.a)({},e)})),l=n.user,s=n.coupon,i=Object(c.useState)(!1),u=Object(r.a)(i,2),p=u[0],m=u[1],f=Object(c.useState)(null),d=Object(r.a)(f,2),b=d[0],g=d[1],w=Object(c.useState)(""),N=Object(r.a)(w,2),x=N[0],C=N[1],k=Object(c.useState)(!0),P=Object(r.a)(k,2),R=P[0],T=P[1],_=Object(c.useState)(""),A=Object(r.a)(_,2),q=A[0],I=A[1],B=Object(c.useState)(0),F=Object(r.a)(B,2),W=(F[0],F[1]),L=Object(c.useState)(0),U=Object(r.a)(L,2),D=U[0],J=U[1],$=Object(c.useState)(0),z=Object(r.a)($,2),M=(z[0],z[1]),Y=Object(y.useStripe)(),H=Object(y.useElements)();Object(c.useEffect)((function(){(function(e,t){return O.a.post("".concat("https://aliexpressclone.herokuapp.com/api","/create-payment-intent"),{couponApplied:t},{headers:{authtoken:e}})})(l.token,s).then((function(e){console.log("create payment intent",e.data),I(e.data.clientSecret),W(e.data.cartTotal),J(e.data.totalAfterDiscount),M(e.data.payable)}))}),[]);var Z=function(){var e=Object(v.a)(E.a.mark((function e(n){var r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),C(!0),e.next=4,Y.confirmCardPayment(q,{payment_method:{card:H.getElement(y.CardElement),billing_details:{name:n.target.name.value}}});case 4:(r=e.sent).error?(g("Payment failed ".concat(r.error.message)),C(!1)):(Object(S.d)(r,l.token).then((function(e){e.data.ok&&("undefined"!==typeof window&&localStorage.removeItem("cart"),t({type:"ADD_TO_CART",payload:[]}),t({type:"COUPON_APPLIED",payload:!1}),Object(S.e)(l.token))})),console.log(JSON.stringify(r,null,4)),g(null),C(!1),m(!0));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(v.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T(t.empty),g(t.error?t.error.message:"");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.a.createElement(o.a.Fragment,null,!p&&o.a.createElement("div",null,s&&void 0!==D?o.a.createElement("p",{className:"alert alert-success"},"Total after discount: $".concat(D)):o.a.createElement("p",{className:"alert alert-danger"},"No coupon applied")),o.a.createElement("div",{className:"text-center pb-5"}),o.a.createElement("form",{onSubmit:Z},o.a.createElement(y.CardElement,{id:"card-element",options:{iconStyle:"solid",style:{base:{iconColor:"#c4f0ff",color:"#000",fontWeight:500,fontFamily:"Roboto, Open Sans, Segoe UI, sans-serif",fontSize:"16px",fontSmoothing:"antialiased",":-webkit-autofill":{color:"#fce883"},"::placeholder":{color:"#87bbfd"}},invalid:{iconColor:"#ffc7ee",color:"#ffc7ee"}}},onChange:G}),o.a.createElement("button",{className:"stripe-button",disabled:x||R||p},o.a.createElement("span",{id:"button-text"},x?o.a.createElement("div",{className:"spinner",id:"spinner"}):"Pay")),o.a.createElement("br",null),b&&o.a.createElement("div",{className:"card-error",role:"alert"},b),o.a.createElement("br",null),o.a.createElement("p",{className:p?"result-message":"result-message hidden"},"Payment Successful."," ",o.a.createElement(j.b,{to:"/user/history"},"See it in your purchase history."))))},N=(n(1102),n(1103),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];d=!0;var r=Date.now();return f.then((function(e){return m(e,t,r)}))}("pk_test_51JCnQjJORWGho4FUKesruIbs54sfrHPWPcQwRjdgm4O3yZnc5ESaj0kFqOJvbRN6YGCKFiCPwLnZMMoywkTpXigh000WVqkxbL"));t.default=function(){var e=Object(h.c)((function(e){return Object(a.a)({},e)})),t=(e.cart,e.user),n=Object(c.useState)([]),l=Object(r.a)(n,2),s=l[0],i=l[1],u=Object(c.useState)(0),p=Object(r.a)(u,2),m=p[0],f=p[1],d=Object(c.useState)({}),b=Object(r.a)(d,2),E=b[0],v=b[1];return Object(c.useEffect)((function(){Object(S.g)(t.token).then((function(e){i(e.data.products),f(e.data.cartTotal),v(e.data.orderdBy.address)}))})),o.a.createElement("main",{className:"main"},o.a.createElement("header",{className:"payment-header"},o.a.createElement("img",{src:"https://ae01.alicdn.com/kf/He14c7c1dc7d84a1fa9a60aba6156278dq.png",alt:"",style:{height:"40px"}})),o.a.createElement("div",{className:"payment-checkout-left"},o.a.createElement("form",{className:"payment-form"},o.a.createElement("p",{className:"instruction"},"don't change informations unles it's necessary"),o.a.createElement("section",{className:"form-section"},o.a.createElement("h2",null,"Shipping & Billing Information"),o.a.createElement("fieldset",null,o.a.createElement("label",null,o.a.createElement("span",null,"Name"),o.a.createElement("input",{type:"text",value:E.name,disabled:!0,className:"field"})),o.a.createElement("label",null,o.a.createElement("span",null,"Phone Number"),o.a.createElement("input",{type:"text",value:E.phoneNumber,disabled:!0,className:"field"})),o.a.createElement("label",null,o.a.createElement("span",null,"Address"),o.a.createElement("input",{type:"text",value:"".concat(E.address1,", ").concat(E.address2),disabled:!0,className:"field"})),o.a.createElement("label",null,o.a.createElement("span",null,"Country"),o.a.createElement("input",{type:"text",value:E.country,disabled:!0,className:"field"})),o.a.createElement("label",null,o.a.createElement("span",null,"City"),o.a.createElement("input",{type:"text",value:E.city,disabled:!0,className:"field"})),o.a.createElement("label",null,o.a.createElement("span",null,"Zip Code"),o.a.createElement("input",{type:"text",value:E.zipCode,disabled:!0,className:"field"}))),o.a.createElement(y.Elements,{stripe:N},o.a.createElement(w,null))))),o.a.createElement("aside",{className:"summary"},o.a.createElement("header",{className:"payment-header1"},o.a.createElement("h1",null,"Order Summary")),o.a.createElement("div",{className:"payment-items"},s.map((function(e){return o.a.createElement("div",{className:"payment-item"},o.a.createElement("img",{class:"image",src:e.product.images[0].url}),o.a.createElement("div",{className:"payment-item-title"},o.a.createElement("p",{className:"payment-item-title-label"},e.product.title.substring(0,50)),o.a.createElement("p",{className:"payment-item-title-color"},e.color&&e.color)),o.a.createElement("p",{className:"payment-item-count"},e.qty," x $ ",e.product.price),o.a.createElement("p",{className:"payment-item-price"},"$",e.qty*e.product.price))}))),o.a.createElement("hr",null),o.a.createElement("div",{className:"payment-total"},o.a.createElement("div",{className:"payment-subtotal"},o.a.createElement("p",null,"Subtotal"),o.a.createElement("p",{className:"payment-item-price"},"$",m)),o.a.createElement("div",{className:"payment-subtotal"},o.a.createElement("p",null,"Shipping"),o.a.createElement("p",{className:"payment-item-price"},"free")),o.a.createElement("div",{className:"payment-subtotal"},o.a.createElement("p",{style:{fontSize:"20px"}},"Total"),o.a.createElement("p",{className:"payment-item-price",style:{fontSize:"20px"}},"$",m)))))}},691:function(e,t,n){!function(e,t){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,a=!1,c=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(s){a=!0,c=s}finally{try{r||null==l.return||l.return()}finally{if(a)throw c}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(){}function o(){}t=t&&t.hasOwnProperty("default")?t.default:t,o.resetWarningCache=c;var l=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){e.exports=function(){function e(e,t,n,r,a,c){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==c){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:c};return n.PropTypes=n,n}()})),s=function(e){return null!==e&&"object"===n(e)},i=function e(t,n){if(!s(t)||!s(n))return t===n;var r=Array.isArray(t);if(r!==Array.isArray(n))return!1;var a="[object Object]"===Object.prototype.toString.call(t);if(a!==("[object Object]"===Object.prototype.toString.call(n)))return!1;if(!a&&!r)return!1;var c=Object.keys(t),o=Object.keys(n);if(c.length!==o.length)return!1;for(var l={},i=0;i<c.length;i+=1)l[c[i]]=!0;for(var u=0;u<o.length;u+=1)l[o[u]]=!0;var p=Object.keys(l);if(p.length!==c.length)return!1;var m=t,f=n;return p.every((function(t){return e(m[t],f[t])}))},u=function(e){var n=t.useRef(e);return t.useEffect((function(){n.current=e}),[e]),n.current},p=function(e){if(null===e||s(t=e)&&"function"===typeof t.elements&&"function"===typeof t.createToken&&"function"===typeof t.createPaymentMethod&&"function"===typeof t.confirmCardPayment)return e;var t;throw new Error("Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.")},m=function(e){if(function(e){return s(e)&&"function"===typeof e.then}(e))return{tag:"async",stripePromise:Promise.resolve(e).then(p)};var t=p(e);return null===t?{tag:"empty"}:{tag:"sync",stripe:t}},f=t.createContext(null);f.displayName="ElementsContext";var d=function(e){var n=e.stripe,r=e.options,c=e.children,o=t.useRef(!1),l=t.useRef(!0),s=t.useMemo((function(){return m(n)}),[n]),p=a(t.useState((function(){return{stripe:null,elements:null}})),2),d=p[0],y=p[1],b=u(n),E=u(r);return null!==b&&(b!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it."),i(r,E)||console.warn("Unsupported prop change on Elements: You cannot change the `options` prop after setting the `stripe` prop.")),o.current||("sync"===s.tag&&(o.current=!0,y({stripe:s.stripe,elements:s.stripe.elements(r)})),"async"===s.tag&&(o.current=!0,s.stripePromise.then((function(e){e&&l.current&&y({stripe:e,elements:e.elements(r)})})))),t.useEffect((function(){return function(){l.current=!1}}),[]),t.useEffect((function(){var e=d.stripe;e&&e._registerWrapper&&e._registerWrapper({name:"react-stripe-js",version:"1.1.2"})}),[d.stripe]),t.createElement(f.Provider,{value:d},c)};d.propTypes={stripe:l.any,options:l.object};var y=function(e){return function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e}(t.useContext(f),e)},b=function(e){return(0,e.children)(y("mounts <ElementsConsumer>"))};b.propTypes={children:l.func.isRequired};var E=function(e){var n=t.useRef(e);return t.useEffect((function(){n.current=e}),[e]),function(){n.current&&n.current.apply(n,arguments)}},v=function(e){return s(e)?(e.paymentRequest,r(e,["paymentRequest"])):{}},h=function(){},g=function(e,n){var r,a="".concat((r=e).charAt(0).toUpperCase()+r.slice(1),"Element"),c=n?function(e){y("mounts <".concat(a,">"));var n=e.id,r=e.className;return t.createElement("div",{id:n,className:r})}:function(n){var r=n.id,c=n.className,o=n.options,l=void 0===o?{}:o,s=n.onBlur,u=void 0===s?h:s,p=n.onFocus,m=void 0===p?h:p,f=n.onReady,d=void 0===f?h:f,b=n.onChange,g=void 0===b?h:b,O=n.onEscape,j=void 0===O?h:O,S=n.onClick,w=void 0===S?h:S,N=y("mounts <".concat(a,">")).elements,x=t.useRef(null),C=t.useRef(null),k=E(d),P=E(u),R=E(m),T=E(w),_=E(g),A=E(j);t.useLayoutEffect((function(){if(null==x.current&&N&&null!=C.current){var t=N.create(e,l);x.current=t,t.mount(C.current),t.on("ready",(function(){return k(t)})),t.on("change",_),t.on("blur",P),t.on("focus",R),t.on("escape",A),t.on("click",T)}}));var q=t.useRef(l);return t.useEffect((function(){q.current&&q.current.paymentRequest!==l.paymentRequest&&console.warn("Unsupported prop change: options.paymentRequest is not a customizable property.");var e=v(l);0===Object.keys(e).length||i(e,v(q.current))||x.current&&(x.current.update(e),q.current=l)}),[l]),t.useEffect((function(){return function(){x.current&&x.current.destroy()}}),[]),t.createElement("div",{id:r,className:c,ref:C})};return c.propTypes={id:l.string,className:l.string,onChange:l.func,onBlur:l.func,onFocus:l.func,onReady:l.func,onClick:l.func,options:l.object},c.displayName=a,c.__elementType=e,c},O="undefined"===typeof window,j=g("auBankAccount",O),S=g("card",O),w=g("cardNumber",O),N=g("cardExpiry",O),x=g("cardCvc",O),C=g("fpxBank",O),k=g("iban",O),P=g("idealBank",O),R=g("paymentRequestButton",O);e.AuBankAccountElement=j,e.CardCvcElement=x,e.CardElement=S,e.CardExpiryElement=N,e.CardNumberElement=w,e.Elements=d,e.ElementsConsumer=b,e.FpxBankElement=C,e.IbanElement=k,e.IdealBankElement=P,e.PaymentRequestButtonElement=R,e.useElements=function(){return y("calls useElements()").elements},e.useStripe=function(){return y("calls useStripe()").stripe},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1))}}]);
//# sourceMappingURL=16.f3348c70.chunk.js.map